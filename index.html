
<script>
    Telegram.WebApp.ready();
    Telegram.WebApp.expand();

    let qrText = null;

    document.getElementById('scan-btn').addEventListener('click', () => {
        console.log("Открытие нативного сканера Telegram...");
        Telegram.WebApp.showScanQrPopup({});
    });

    Telegram.WebApp.onEvent('qrTextReceived', (event) => {
        console.log("QR-код получен:", event.data);
        Telegram.WebApp.closeScanQrPopup();
        qrText = event.data;

        // Показать основную кнопку Telegram
        Telegram.WebApp.MainButton.setText('✅ Отправить QR-код');
        Telegram.WebApp.MainButton.show();
    });

    Telegram.WebApp.MainButton.onClick(() => {
        if (qrText) {
            try {
                Telegram.WebApp.sendData(qrText);
                console.log("✅ QR-код отправлен:", qrText);
            } catch (error) {
                console.error("Ошибка отправки через sendData:", error);
            }
        } else {
            console.error("QR-код пустой. Невозможно отправить.");
        }
    });

    document.getElementById('close-btn').addEventListener('click', () => {
        Telegram.WebApp.close();
    });
</script>


